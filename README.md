## Php-fpm

[![Ansible Galaxy](http://img.shields.io/badge/galaxy-DimitriSteyaert/php--fpm-660198.svg?style=flat)](https://galaxy.ansible.com/detail#/role/DimitriSteyaert)


This role installs and configures the PHP FastCGI Process Manager with the version of your choice and lets you manage the PHP-FPM pools and PHP modules.

### Installation

This role requires at least Ansible `v1.9`. To install it, run:

```Shell
ansible-galaxy install DimitriSteyaert/php-fpm
```

### Role variables

List of default variables available in the inventory:

```YAML
---
php_fpm_version: 7.0
php_fpm_state: present
php_fpm_purge: no

# PHP configuration parameters
php_fpm_ini_short_open_tag: 'Off'
php_fpm_ini_max_execution_time: 30
php_fpm_ini_max_input_time: 60
php_fpm_ini_memory_limit: 128M
php_fpm_ini_error_reporting: 'E_ALL & ~E_DEPRECATED & ~E_STRICT'
php_fpm_ini_display_errors: 'Off'
php_fpm_ini_post_max_size: 8M
php_fpm_ini_upload_max_filesize: 2M

php_fpm_pid_file: "/run/php/php{{ php_fpm_version }}-fpm.pid"
php_fpm_log_level: notice

# PHP-FPM pool configurations
php_fpm_remove_default_www: yes
php_fpm_pools: []
```


### Detailed usage guide

By default version 7.0 is installed but you can define the version of your choice. Just keep in mind to only define the major.minor verions and not the patch levels (eg 5.6, 7.0, 7.1,...)
#### Examples

This is a basic playbook to install Php-fpm with the default variables:

```YAML
---
- hosts: all
  roles:
    - php-fpm
```

To further configure PHP-FPM with your own settings, add a few pools and add some additional PHP modules you can use the following example. The first pool uses the pool's default settings as defined in the template. The second one shows you all the possible parameters to pass to the pool configuration with some custom settings.

```YAML
---
php_fpm_pools:
  - name: example.org
    user: exampleorg
    group: www-data
  - name: sub.example.org
    user: subexampleorg
    group: www-data
    pm: dynamic
    pm_start_servers: 10
    pm_process_idle_timeout: 20s
    pm_min_spare_servers: 2
    pm_max_spare_servers: 5
    pm_max_requests: 500
php_fpm_modules:
  - name: php7.0-curl
    state: installed
  - name: php7.0-intl
    state: installed
php_fpm_ini_memory_limit: 512M
```

### Authors and license

The `php-fpm` role was written by:

- [Dimitri Steyaert](https://www.steyaert.be) | [e-mail](mailto:dimitri@steyaert.be) | [Twitter](https://twitter.com/DimitriSteyaert)

License: [MIT](https://tldrlegal.com/license/mit-license)

***

README generated by [Ansigenome](https://github.com/nickjj/ansigenome/).
